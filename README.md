# Semi-supervised Gland Segmentation via Feature-enhanced Contrastive Learning and Dual-consistency Strategy (JBHI2025)

# Abstract
In the ffeld of gland segmentation in histopathology, deep-learning methods have made signiffcant progress. However, most existing methods not only require a large amount of high-quality annotated data but also tend to confuse the internal of the gland with the background. To address this challenge, we propose a new semi-supervised method named DCCL-Seg for gland segmentation, which follows the teacher-student framework. Our approach can be divided into follows steps. First, we design a contrastive learning module to improve the ability of the student model’s feature extractor to distinguish between gland and background features. Then, we introduce a Signed Distance Field (SDF) prediction task and employ dual-consistency strategy (across tasks and models) to better reinforce the learning of gland internal.
Next, we proposed a pseudo label ffltering and reweighting mechanism, which fflters and reweights the pseudo labels generated by the teacher model based on conffdence. However, even after reweighting, the pseudo labels may still be inffuenced by unreliable pixels. Finally, we further designed an assistant predictor to learn the reweighted pseudo labels, which do not interfere with the student model’s predictor and ensure the reliability of the student model’s predictions. Experimental results on the publicly available GlaS and CRAG datasets demonstrate that our method outperforms other semi-supervised medical image segmentation methods.

# Environment
- Ubuntu 20.04
- NVIDIA RTX 3090 GPU
- Python 3.8
- Pytorch 2.0.1

# Datasets
- [GlaS](https://datasets.activeloop.ai/docs/ml/datasets/glas-dataset/)
- [CRAG](https://warwick.ac.uk/fac/cross_fac/tia/data/mildnet/)

# Run the DCCL_Seg
python train_DCCL_Seg.py --alpha=1 --batch-size=8 --lr=0.0005 --epochs=1000 --gpu=1 --save-dir=./experiments/GlaS/newcrop/DCCL_Seg

# Citation
If you find this code repository useful, please consider citing our paper:
```text
@ARTICLE{10908057,
  author={Yu, Jiejiang and Li, Bingbing and Pan, Xipeng and Shi, Zhenwei and Wang, Huadeng and Lan, Rushi and Luo, Xiaonan},
  journal={IEEE Journal of Biomedical and Health Informatics}, 
  title={Semi-Supervised Gland Segmentation via Feature-Enhanced Contrastive Learning and Dual-Consistency Strategy}, 
  year={2025},
  volume={29},
  number={6},
  pages={4314-4324},
  keywords={Glands;Image segmentation;Predictive models;Contrastive learning;Feature extraction;Data models;Biomedical imaging;Training;Semisupervised learning;Artificial intelligence;Semi-supervised learning;gland segmentation;contrastive learning;pseudo label reweighting},
  doi={10.1109/JBHI.2025.3546698}}
```
